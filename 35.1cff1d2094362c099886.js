(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{cq7r:function(t,e,o){"use strict";o.r(e),o.d(e,"SubAccountAddPageModule",function(){return T});var n=o("138U"),i=o("ofXK"),c=o("3Pt+"),s=o("tyNb"),r=o("TEn/"),a=o("sYmb"),l=o("j1ZV"),b=o("mrSG"),u=o("RKiA"),d=o("Z7VQ"),h=o("peH2"),p=o("QMTT"),f=o("57MG"),y=o("kB5k"),m=o.n(y),g=o("fXoL"),w=function(t){return{typeLabel:t}};function v(t,e){if(1&t&&(g.Kb(0,"empty-state",13),g.Zb(1,"translate"),g.Zb(2,"translate")),2&t){var o=g.Yb();g.ec("text",g.bc(1,3,"add-sub-account.no-imports_text",g.ic(8,w,g.ac(2,6,o.typeLabel))))("imageName",o.wallet.protocol.identifier===o.mainProtocolSymbols.XTZ?"no-imports.svg":"currencies-empty.svg")("fullHeight",o.wallet.protocol.identifier!==o.mainProtocolSymbols.XTZ)}}function P(t,e){if(1&t){var o=g.Pb();g.Ob(0,"ion-row",14),g.Ob(1,"ion-col",15),g.Ob(2,"portfolio-item",16),g.Wb("click",function(){g.mc(o);var t=e.$implicit;return g.Yb().toggleAccount(t)}),g.Nb(),g.Nb(),g.Ob(3,"ion-col",17),g.Ob(4,"ion-checkbox",18),g.Wb("ngModelChange",function(t){return e.$implicit.selected=t}),g.Nb(),g.Nb(),g.Nb()}if(2&t){var n=e.$implicit,i=g.Yb();g.yb(2),g.ec("isToken",i.subProtocolType===i.subProtocolTypes.TOKEN)("wallet",n.wallet),g.yb(2),g.ec("ngModel",n.selected)}}var O=function(){function t(t,e,o,n,i){if(this.navController=t,this.route=e,this.accountProvider=o,this.priceService=n,this.protocolService=i,this.mainProtocolSymbols=u.MainProtocolSymbols,this.subAccounts=[],this.filteredSubAccounts=[],this.displayedSubAccounts=[],this.subProtocolTypes=d.SubProtocolType,this.typeLabel="",this.searchTerm="",this.infiniteEnabled=!1,this.limit=10,this.loaded=0,this.publicKey=this.route.snapshot.params.publicKey,this.protocolID=this.route.snapshot.params.protocolID,this.addressIndex=this.route.snapshot.params.addressIndex,this.subProtocolType=this.route.snapshot.params.subProtocolType,"undefined"===this.addressIndex&&(this.addressIndex=void 0),this.wallet=this.accountProvider.walletByPublicKeyAndProtocolAndAddressIndex(this.publicKey,this.protocolID,this.addressIndex),this.route.snapshot.data.special){var c=this.route.snapshot.data.special;this.actionCallback=c.actionCallback,this.subProtocolType=c.subProtocolType,this.wallet=c.wallet}this.subProtocolType===d.SubProtocolType.ACCOUNT?this.initWithAccountSubProtocol():this.subProtocolType===d.SubProtocolType.TOKEN?this.initWithTokenSubProtocol():Object(h.assertNever)(this.subProtocolType)}return t.prototype.toggleAccount=function(t){t.selected=!t.selected},t.prototype.addSubAccounts=function(){this.actionCallback({subAccounts:this.subAccounts,accountProvider:this.accountProvider,location:this.navController})},t.prototype.initWithAccountSubProtocol=function(){this.typeLabel="add-sub-account.accounts_label"},t.prototype.initWithTokenSubProtocol=function(){return Object(b.b)(this,void 0,void 0,function(){var t,e;return Object(b.e)(this,function(o){switch(o.label){case 0:return this.typeLabel="add-sub-account.tokens_label",[4,this.protocolService.getSubProtocols(this.wallet.protocol.identifier)];case 1:return t=o.sent().filter(function(t){return t.subProtocolType===d.SubProtocolType.TOKEN}),this.infiniteEnabled=!0,e=this,[4,this.loadSubAccounts(t)];case 2:return e.subAccounts=o.sent(),[4,this.loadDisplayedAccounts()];case 3:return o.sent(),[2]}})})},t.prototype.loadSubAccounts=function(t){return Object(b.b)(this,void 0,void 0,function(){var e=this;return Object(b.e)(this,function(o){switch(o.label){case 0:return[4,this.wallet.protocol.getBalanceOfPublicKeyForSubProtocols(this.wallet.publicKey,t)];case 1:return[2,o.sent().map(function(o,n){var i=new u.AirGapMarketWallet(t[n],e.wallet.publicKey,e.wallet.isExtendedPublicKey,e.wallet.derivationPath,e.priceService);if(!e.accountProvider.walletExists(i))return i.addresses=e.wallet.addresses,i.currentBalance=new m.a(o),{wallet:i,selected:!1}}).filter(function(t){return void 0!==t}).sort(function(t,e){return-1*t.wallet.currentBalance.minus(e.wallet.currentBalance).toNumber()})]}})})},t.prototype.setFilteredItems=function(t){if(this.displayedSubAccounts=[],this.loaded=0,0===t.length)this.infiniteEnabled=!0,this.loadDisplayedAccounts();else{var e=t.toLowerCase();this.filteredSubAccounts=this.subAccounts.filter(function(t){var o=t.wallet.protocol.name.toLowerCase().includes(e),n=t.wallet.protocol.symbol.toLowerCase().includes(e);return o||n}),this.infiniteEnabled=!1,this.loadDisplayedAccounts(!0)}},t.prototype.loadDisplayedAccounts=function(t){return void 0===t&&(t=!1),Object(b.b)(this,void 0,void 0,function(){var e,o=this;return Object(b.e)(this,function(n){return(e=(t?this.filteredSubAccounts:this.subAccounts).slice(this.loaded,this.loaded+this.limit)).length<this.limit&&(this.infiniteEnabled=!1),e.forEach(function(t){void 0===t.wallet.currentMarketPrice&&t.wallet.fetchCurrentMarketPrice(),o.displayedSubAccounts.push(t)}),this.loaded+=e.length,[2]})})},t.prototype.doInfinite=function(t){return Object(b.b)(this,void 0,void 0,function(){return Object(b.e)(this,function(e){switch(e.label){case 0:return this.infiniteEnabled?[4,this.loadDisplayedAccounts()]:[2,t.target.complete()];case 1:return e.sent(),t.target.complete(),[2]}})})},t.\u0275fac=function(e){return new(e||t)(g.Jb(r.mb),g.Jb(s.a),g.Jb(f.a),g.Jb(p.a),g.Jb(n.x))},t.\u0275cmp=g.Db({type:t,selectors:[["page-sub-account-add"]],decls:28,vars:23,consts:[[1,"ion-no-border"],["fixed","true",1,"ion-no-padding"],["slot","start"],["defaultHref","/"],[3,"ngModel","ngModelChange","ionChange"],[1,"ion-padding"],["color","primary",1,"font--weight__bold"],[3,"text","imageName","fullHeight",4,"ngIf"],["class","ion-no-padding",4,"ngFor","ngForOf"],[3,"ionInfinite"],["vertical","bottom","horizontal","end","slot","fixed"],["shape","round","color","secondary",3,"disabled","click"],["slot","start","name","add"],[3,"text","imageName","fullHeight"],[1,"ion-no-padding"],["size","10",1,"ion-no-padding"],["tappable","",3,"isToken","wallet","click"],["size","2",1,"content--align__center-center","ion-no-padding"],["color","primary",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(g.Ob(0,"ion-header",0),g.Ob(1,"ion-grid",1),g.Ob(2,"ion-toolbar"),g.Ob(3,"ion-buttons",2),g.Kb(4,"ion-back-button",3),g.Nb(),g.Ob(5,"ion-title"),g.vc(6),g.Zb(7,"translate"),g.Zb(8,"translate"),g.Nb(),g.Nb(),g.Ob(9,"ion-toolbar"),g.Ob(10,"ion-searchbar",4),g.Wb("ngModelChange",function(t){return e.searchTerm=t})("ionChange",function(){return e.setFilteredItems(e.searchTerm)}),g.Nb(),g.Nb(),g.Nb(),g.Nb(),g.Ob(11,"ion-content"),g.Ob(12,"ion-grid",1),g.Ob(13,"ion-row",5),g.Ob(14,"ion-text",6),g.Ob(15,"span"),g.vc(16),g.Zb(17,"translate"),g.Nb(),g.Nb(),g.Nb(),g.tc(18,v,3,10,"empty-state",7),g.tc(19,P,5,3,"ion-row",8),g.Nb(),g.Ob(20,"ion-infinite-scroll",9),g.Wb("ionInfinite",function(t){return e.doInfinite(t)}),g.Kb(21,"ion-infinite-scroll-content"),g.Nb(),g.Ob(22,"ion-fab",10),g.Ob(23,"ion-button",11),g.Wb("click",function(){return e.addSubAccounts()}),g.Kb(24,"ion-icon",12),g.vc(25),g.Zb(26,"translate"),g.Zb(27,"translate"),g.Nb(),g.Nb(),g.Nb()),2&t&&(g.yb(6),g.wc(g.bc(7,7,"add-sub-account.title",g.ic(19,w,g.ac(8,10,e.typeLabel)))),g.yb(4),g.ec("ngModel",e.searchTerm),g.yb(6),g.wc(g.ac(17,12,e.typeLabel)),g.yb(2),g.ec("ngIf",!e.subAccounts.length),g.yb(1),g.ec("ngForOf",e.displayedSubAccounts),g.yb(4),g.ec("disabled",!e.subAccounts.length),g.yb(2),g.xc(" ",g.bc(26,14,"add-sub-account.add-accounts_label",g.ic(21,w,g.ac(27,17,e.typeLabel)))," "))},styles:[".empty-list[_ngcontent-%COMP%]{height:50%}span[_ngcontent-%COMP%]{font-size:14px}"]}),t}(),A=o("1Mpf"),S=o("F07p"),T=function(){function t(){}return t.\u0275mod=g.Hb({type:t}),t.\u0275inj=g.Gb({factory:function(e){return new(e||t)},imports:[[r.ib,i.c,c.e,l.a,a.b,s.j.forChild([{path:"",component:O}]),n.d]]}),t}();g.pc(O,[r.v,r.u,r.hb,r.j,r.f,r.g,r.fb,r.S,r.ub,c.h,c.j,r.q,r.R,r.db,i.n,A.a,i.m,r.p,S.a,r.o,r.b,r.x,r.y,r.r,r.i,r.w],[a.c])}}]);