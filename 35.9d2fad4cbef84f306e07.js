(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{cq7r:function(t,e,o){"use strict";o.r(e),o.d(e,"SubAccountAddPageModule",function(){return S});var n=o("138U"),i=o("ofXK"),c=o("3Pt+"),a=o("tyNb"),s=o("TEn/"),r=o("sYmb"),l=o("j1ZV"),u=o("mrSG"),d=o("RKiA"),b=o("Z7VQ"),p=o("peH2"),h=o("QMTT"),A=o("57MG"),f=o("kB5k"),g=o.n(f),y=o("fXoL"),_c0=function(t){return{typeLabel:t}};function SubAccountAddPage_empty_state_18_Template(t,e){if(1&t&&(y.Kb(0,"empty-state",13),y.Zb(1,"translate"),y.Zb(2,"translate")),2&t){var o=y.Yb();y.ec("text",y.bc(1,3,"add-sub-account.no-imports_text",y.ic(8,_c0,y.ac(2,6,o.typeLabel))))("imageName",o.wallet.protocol.identifier===o.mainProtocolSymbols.XTZ?"no-imports.svg":"currencies-empty.svg")("fullHeight",o.wallet.protocol.identifier!==o.mainProtocolSymbols.XTZ)}}function SubAccountAddPage_ion_row_19_Template(t,e){if(1&t){var o=y.Pb();y.Ob(0,"ion-row",14),y.Ob(1,"ion-col",15),y.Ob(2,"portfolio-item",16),y.Wb("click",function SubAccountAddPage_ion_row_19_Template_portfolio_item_click_2_listener(){y.mc(o);var t=e.$implicit;return y.Yb().toggleAccount(t)}),y.Nb(),y.Nb(),y.Ob(3,"ion-col",17),y.Ob(4,"ion-checkbox",18),y.Wb("ngModelChange",function SubAccountAddPage_ion_row_19_Template_ion_checkbox_ngModelChange_4_listener(t){return e.$implicit.selected=t}),y.Nb(),y.Nb(),y.Nb()}if(2&t){var n=e.$implicit,i=y.Yb();y.yb(2),y.ec("isToken",i.subProtocolType===i.subProtocolTypes.TOKEN)("wallet",n.wallet),y.yb(2),y.ec("ngModel",n.selected)}}var P=function(){function SubAccountAddPage(t,e,o,n,i){if(this.navController=t,this.route=e,this.accountProvider=o,this.priceService=n,this.protocolService=i,this.mainProtocolSymbols=d.MainProtocolSymbols,this.subAccounts=[],this.filteredSubAccounts=[],this.displayedSubAccounts=[],this.subProtocolTypes=b.SubProtocolType,this.typeLabel="",this.searchTerm="",this.infiniteEnabled=!1,this.limit=10,this.loaded=0,this.publicKey=this.route.snapshot.params.publicKey,this.protocolID=this.route.snapshot.params.protocolID,this.addressIndex=this.route.snapshot.params.addressIndex,this.subProtocolType=this.route.snapshot.params.subProtocolType,"undefined"===this.addressIndex&&(this.addressIndex=void 0),this.wallet=this.accountProvider.walletByPublicKeyAndProtocolAndAddressIndex(this.publicKey,this.protocolID,this.addressIndex),this.route.snapshot.data.special){var c=this.route.snapshot.data.special;this.actionCallback=c.actionCallback,this.subProtocolType=c.subProtocolType,this.wallet=c.wallet}this.subProtocolType===b.SubProtocolType.ACCOUNT?this.initWithAccountSubProtocol():this.subProtocolType===b.SubProtocolType.TOKEN?this.initWithTokenSubProtocol():Object(p.assertNever)(this.subProtocolType)}return SubAccountAddPage.prototype.toggleAccount=function(t){t.selected=!t.selected},SubAccountAddPage.prototype.addSubAccounts=function(){this.actionCallback({subAccounts:this.subAccounts,accountProvider:this.accountProvider,location:this.navController})},SubAccountAddPage.prototype.initWithAccountSubProtocol=function(){this.typeLabel="add-sub-account.accounts_label"},SubAccountAddPage.prototype.initWithTokenSubProtocol=function(){return Object(u.b)(this,void 0,void 0,function(){var t,e;return Object(u.e)(this,function(o){switch(o.label){case 0:return this.typeLabel="add-sub-account.tokens_label",[4,this.protocolService.getSubProtocols(this.wallet.protocol.identifier)];case 1:return t=o.sent().filter(function(t){return t.subProtocolType===b.SubProtocolType.TOKEN}),this.infiniteEnabled=!0,e=this,[4,this.loadSubAccounts(t)];case 2:return e.subAccounts=o.sent(),[4,this.loadDisplayedAccounts()];case 3:return o.sent(),[2]}})})},SubAccountAddPage.prototype.loadSubAccounts=function(t){return Object(u.b)(this,void 0,void 0,function(){var e=this;return Object(u.e)(this,function(o){switch(o.label){case 0:return[4,this.wallet.protocol.getBalanceOfPublicKeyForSubProtocols(this.wallet.publicKey,t)];case 1:return[2,o.sent().map(function(o,n){var i=new d.AirGapMarketWallet(t[n],e.wallet.publicKey,e.wallet.isExtendedPublicKey,e.wallet.derivationPath,e.priceService);if(!e.accountProvider.walletExists(i))return i.addresses=e.wallet.addresses,i.currentBalance=new g.a(o),{wallet:i,selected:!1}}).filter(function(t){return void 0!==t}).sort(function(t,e){return-1*t.wallet.currentBalance.minus(e.wallet.currentBalance).toNumber()})]}})})},SubAccountAddPage.prototype.setFilteredItems=function(t){if(this.displayedSubAccounts=[],this.loaded=0,0===t.length)this.infiniteEnabled=!0,this.loadDisplayedAccounts();else{var e=t.toLowerCase();this.filteredSubAccounts=this.subAccounts.filter(function(t){var o=t.wallet.protocol.name.toLowerCase().includes(e),n=t.wallet.protocol.symbol.toLowerCase().includes(e);return o||n}),this.infiniteEnabled=!1,this.loadDisplayedAccounts(!0)}},SubAccountAddPage.prototype.loadDisplayedAccounts=function(t){return void 0===t&&(t=!1),Object(u.b)(this,void 0,void 0,function(){var e,o=this;return Object(u.e)(this,function(n){return(e=(t?this.filteredSubAccounts:this.subAccounts).slice(this.loaded,this.loaded+this.limit)).length<this.limit&&(this.infiniteEnabled=!1),e.forEach(function(t){void 0===t.wallet.currentMarketPrice&&t.wallet.fetchCurrentMarketPrice(),o.displayedSubAccounts.push(t)}),this.loaded+=e.length,[2]})})},SubAccountAddPage.prototype.doInfinite=function(t){return Object(u.b)(this,void 0,void 0,function(){return Object(u.e)(this,function(e){switch(e.label){case 0:return this.infiniteEnabled?[4,this.loadDisplayedAccounts()]:[2,t.target.complete()];case 1:return e.sent(),t.target.complete(),[2]}})})},SubAccountAddPage.\u0275fac=function SubAccountAddPage_Factory(t){return new(t||SubAccountAddPage)(y.Jb(s.mb),y.Jb(a.a),y.Jb(A.a),y.Jb(h.a),y.Jb(n.x))},SubAccountAddPage.\u0275cmp=y.Db({type:SubAccountAddPage,selectors:[["page-sub-account-add"]],decls:28,vars:23,consts:[[1,"ion-no-border"],["fixed","true",1,"ion-no-padding"],["slot","start"],["defaultHref","/"],[3,"ngModel","ngModelChange","ionChange"],[1,"ion-padding"],["color","primary",1,"font--weight__bold"],[3,"text","imageName","fullHeight",4,"ngIf"],["class","ion-no-padding",4,"ngFor","ngForOf"],[3,"ionInfinite"],["vertical","bottom","horizontal","end","slot","fixed"],["shape","round","color","secondary",3,"disabled","click"],["slot","start","name","add"],[3,"text","imageName","fullHeight"],[1,"ion-no-padding"],["size","10",1,"ion-no-padding"],["tappable","",3,"isToken","wallet","click"],["size","2",1,"content--align__center-center","ion-no-padding"],["color","primary",3,"ngModel","ngModelChange"]],template:function SubAccountAddPage_Template(t,e){1&t&&(y.Ob(0,"ion-header",0),y.Ob(1,"ion-grid",1),y.Ob(2,"ion-toolbar"),y.Ob(3,"ion-buttons",2),y.Kb(4,"ion-back-button",3),y.Nb(),y.Ob(5,"ion-title"),y.vc(6),y.Zb(7,"translate"),y.Zb(8,"translate"),y.Nb(),y.Nb(),y.Ob(9,"ion-toolbar"),y.Ob(10,"ion-searchbar",4),y.Wb("ngModelChange",function SubAccountAddPage_Template_ion_searchbar_ngModelChange_10_listener(t){return e.searchTerm=t})("ionChange",function SubAccountAddPage_Template_ion_searchbar_ionChange_10_listener(){return e.setFilteredItems(e.searchTerm)}),y.Nb(),y.Nb(),y.Nb(),y.Nb(),y.Ob(11,"ion-content"),y.Ob(12,"ion-grid",1),y.Ob(13,"ion-row",5),y.Ob(14,"ion-text",6),y.Ob(15,"span"),y.vc(16),y.Zb(17,"translate"),y.Nb(),y.Nb(),y.Nb(),y.tc(18,SubAccountAddPage_empty_state_18_Template,3,10,"empty-state",7),y.tc(19,SubAccountAddPage_ion_row_19_Template,5,3,"ion-row",8),y.Nb(),y.Ob(20,"ion-infinite-scroll",9),y.Wb("ionInfinite",function SubAccountAddPage_Template_ion_infinite_scroll_ionInfinite_20_listener(t){return e.doInfinite(t)}),y.Kb(21,"ion-infinite-scroll-content"),y.Nb(),y.Ob(22,"ion-fab",10),y.Ob(23,"ion-button",11),y.Wb("click",function SubAccountAddPage_Template_ion_button_click_23_listener(){return e.addSubAccounts()}),y.Kb(24,"ion-icon",12),y.vc(25),y.Zb(26,"translate"),y.Zb(27,"translate"),y.Nb(),y.Nb(),y.Nb()),2&t&&(y.yb(6),y.wc(y.bc(7,7,"add-sub-account.title",y.ic(19,_c0,y.ac(8,10,e.typeLabel)))),y.yb(4),y.ec("ngModel",e.searchTerm),y.yb(6),y.wc(y.ac(17,12,e.typeLabel)),y.yb(2),y.ec("ngIf",!e.subAccounts.length),y.yb(1),y.ec("ngForOf",e.displayedSubAccounts),y.yb(4),y.ec("disabled",!e.subAccounts.length),y.yb(2),y.xc(" ",y.bc(26,14,"add-sub-account.add-accounts_label",y.ic(21,_c0,y.ac(27,17,e.typeLabel)))," "))},styles:[".empty-list[_ngcontent-%COMP%]{height:50%}span[_ngcontent-%COMP%]{font-size:14px}"]}),SubAccountAddPage}(),_=o("1Mpf"),m=o("F07p"),S=function(){function SubAccountAddPageModule(){}return SubAccountAddPageModule.\u0275mod=y.Hb({type:SubAccountAddPageModule}),SubAccountAddPageModule.\u0275inj=y.Gb({factory:function SubAccountAddPageModule_Factory(t){return new(t||SubAccountAddPageModule)},imports:[[s.ib,i.c,c.e,l.a,r.b,a.j.forChild([{path:"",component:P}]),n.d]]}),SubAccountAddPageModule}();y.pc(P,[s.v,s.u,s.hb,s.j,s.f,s.g,s.fb,s.S,s.ub,c.h,c.j,s.q,s.R,s.db,i.n,_.a,i.m,s.p,m.a,s.o,s.b,s.x,s.y,s.r,s.i,s.w],[r.c])}}]);