(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{cq7r:function(t,e,o){"use strict";o.r(e),o.d(e,"SubAccountAddPageModule",function(){return k});var n=o("138U"),i=o("ofXK"),c=o("3Pt+"),s=o("tyNb"),r=o("TEn/"),a=o("sYmb"),l=o("j1ZV"),u=o("mrSG"),b=o("RKiA"),d=o("Z7VQ"),h=o("peH2"),p=o("QMTT"),f=o("57MG"),y=o("kB5k"),g=o.n(y),P=o("fXoL"),m=function(t){return{typeLabel:t}};function w(t,e){if(1&t&&(P.Mb(0,"empty-state",13),P.bc(1,"translate"),P.bc(2,"translate")),2&t){var o=P.ac();P.gc("text",P.dc(1,3,"add-sub-account.no-imports_text",P.kc(8,m,P.cc(2,6,o.typeLabel))))("imageName",o.wallet.protocol.identifier===o.mainProtocolSymbols.XTZ?"no-imports.svg":"currencies-empty.svg")("fullHeight",o.wallet.protocol.identifier!==o.mainProtocolSymbols.XTZ)}}function A(t,e){if(1&t){var o=P.Rb();P.Qb(0,"ion-row",14),P.Qb(1,"ion-col",15),P.Qb(2,"portfolio-item",16),P.Yb("click",function(){P.oc(o);var t=e.$implicit;return P.ac().toggleAccount(t)}),P.Pb(),P.Pb(),P.Qb(3,"ion-col",17),P.Qb(4,"ion-checkbox",18),P.Yb("ngModelChange",function(t){return e.$implicit.selected=t}),P.Pb(),P.Pb(),P.Pb()}if(2&t){var n=e.$implicit,i=P.ac();P.Ab(2),P.gc("isToken",i.subProtocolType===i.subProtocolTypes.TOKEN)("wallet",n.wallet),P.Ab(2),P.gc("ngModel",n.selected)}}var v=function(){function t(t,e,o,n,i){if(this.navController=t,this.route=e,this.accountProvider=o,this.priceService=n,this.protocolService=i,this.mainProtocolSymbols=b.MainProtocolSymbols,this.subAccounts=[],this.filteredSubAccounts=[],this.displayedSubAccounts=[],this.subProtocolTypes=d.SubProtocolType,this.typeLabel="",this.searchTerm="",this.infiniteEnabled=!1,this.limit=10,this.loaded=0,this.publicKey=this.route.snapshot.params.publicKey,this.protocolID=this.route.snapshot.params.protocolID,this.addressIndex=this.route.snapshot.params.addressIndex,this.subProtocolType=this.route.snapshot.params.subProtocolType,"undefined"===this.addressIndex&&(this.addressIndex=void 0),this.wallet=this.accountProvider.walletByPublicKeyAndProtocolAndAddressIndex(this.publicKey,this.protocolID,this.addressIndex),this.route.snapshot.data.special){var c=this.route.snapshot.data.special;this.actionCallback=c.actionCallback,this.subProtocolType=c.subProtocolType,this.wallet=c.wallet}this.subProtocolType===d.SubProtocolType.ACCOUNT?this.initWithAccountSubProtocol():this.subProtocolType===d.SubProtocolType.TOKEN?this.initWithTokenSubProtocol():Object(h.assertNever)(this.subProtocolType)}return t.prototype.toggleAccount=function(t){t.selected=!t.selected},t.prototype.addSubAccounts=function(){this.actionCallback({subAccounts:this.subAccounts,accountProvider:this.accountProvider,location:this.navController})},t.prototype.initWithAccountSubProtocol=function(){this.typeLabel="add-sub-account.accounts_label"},t.prototype.initWithTokenSubProtocol=function(){return Object(u.b)(this,void 0,void 0,function(){var t,e;return Object(u.e)(this,function(o){switch(o.label){case 0:return this.typeLabel="add-sub-account.tokens_label",[4,this.protocolService.getSubProtocols(this.wallet.protocol.identifier)];case 1:return t=o.sent().filter(function(t){return t.subProtocolType===d.SubProtocolType.TOKEN}),this.infiniteEnabled=!0,e=this,[4,this.loadSubAccounts(t)];case 2:return e.subAccounts=o.sent(),[4,this.loadDisplayedAccounts()];case 3:return o.sent(),[2]}})})},t.prototype.loadSubAccounts=function(t){return Object(u.b)(this,void 0,void 0,function(){var e=this;return Object(u.e)(this,function(o){switch(o.label){case 0:return[4,this.wallet.protocol.getBalanceOfPublicKeyForSubProtocols(this.wallet.publicKey,t)];case 1:return[2,o.sent().map(function(o,n){var i=new b.AirGapMarketWallet(t[n],e.wallet.publicKey,e.wallet.isExtendedPublicKey,e.wallet.derivationPath,e.priceService);if(!e.accountProvider.walletExists(i))return i.addresses=e.wallet.addresses,i.currentBalance=new g.a(o),{wallet:i,selected:!1}}).filter(function(t){return void 0!==t}).sort(function(t,e){return-1*t.wallet.currentBalance.minus(e.wallet.currentBalance).toNumber()})]}})})},t.prototype.setFilteredItems=function(t){if(this.displayedSubAccounts=[],this.loaded=0,0===t.length)this.infiniteEnabled=!0,this.loadDisplayedAccounts();else{var e=t.toLowerCase();this.filteredSubAccounts=this.subAccounts.filter(function(t){var o=t.wallet.protocol.name.toLowerCase().includes(e),n=t.wallet.protocol.symbol.toLowerCase().includes(e);return o||n}),this.infiniteEnabled=!1,this.loadDisplayedAccounts(!0)}},t.prototype.loadDisplayedAccounts=function(t){return void 0===t&&(t=!1),Object(u.b)(this,void 0,void 0,function(){var e,o=this;return Object(u.e)(this,function(n){return(e=(t?this.filteredSubAccounts:this.subAccounts).slice(this.loaded,this.loaded+this.limit)).length<this.limit&&(this.infiniteEnabled=!1),e.forEach(function(t){void 0===t.wallet.currentMarketPrice&&t.wallet.fetchCurrentMarketPrice(),o.displayedSubAccounts.push(t)}),this.loaded+=e.length,[2]})})},t.prototype.doInfinite=function(t){return Object(u.b)(this,void 0,void 0,function(){return Object(u.e)(this,function(e){switch(e.label){case 0:return this.infiniteEnabled?[4,this.loadDisplayedAccounts()]:[2,t.target.complete()];case 1:return e.sent(),t.target.complete(),[2]}})})},t.\u0275fac=function(e){return new(e||t)(P.Lb(r.mb),P.Lb(s.a),P.Lb(f.a),P.Lb(p.a),P.Lb(n.y))},t.\u0275cmp=P.Fb({type:t,selectors:[["page-sub-account-add"]],decls:28,vars:23,consts:[[1,"ion-no-border"],["fixed","true",1,"ion-no-padding"],["slot","start"],["defaultHref","/"],[3,"ngModel","ngModelChange","ionChange"],[1,"ion-padding"],["color","primary",1,"font--weight__bold"],[3,"text","imageName","fullHeight",4,"ngIf"],["class","ion-no-padding",4,"ngFor","ngForOf"],[3,"ionInfinite"],["vertical","bottom","horizontal","end","slot","fixed"],["shape","round","color","secondary",3,"disabled","click"],["slot","start","name","add"],[3,"text","imageName","fullHeight"],[1,"ion-no-padding"],["size","10",1,"ion-no-padding"],["tappable","",3,"isToken","wallet","click"],["size","2",1,"content--align__center-center","ion-no-padding"],["color","primary",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(P.Qb(0,"ion-header",0),P.Qb(1,"ion-grid",1),P.Qb(2,"ion-toolbar"),P.Qb(3,"ion-buttons",2),P.Mb(4,"ion-back-button",3),P.Pb(),P.Qb(5,"ion-title"),P.wc(6),P.bc(7,"translate"),P.bc(8,"translate"),P.Pb(),P.Pb(),P.Qb(9,"ion-toolbar"),P.Qb(10,"ion-searchbar",4),P.Yb("ngModelChange",function(t){return e.searchTerm=t})("ionChange",function(){return e.setFilteredItems(e.searchTerm)}),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Qb(11,"ion-content"),P.Qb(12,"ion-grid",1),P.Qb(13,"ion-row",5),P.Qb(14,"ion-text",6),P.Qb(15,"span"),P.wc(16),P.bc(17,"translate"),P.Pb(),P.Pb(),P.Pb(),P.uc(18,w,3,10,"empty-state",7),P.uc(19,A,5,3,"ion-row",8),P.Pb(),P.Qb(20,"ion-infinite-scroll",9),P.Yb("ionInfinite",function(t){return e.doInfinite(t)}),P.Mb(21,"ion-infinite-scroll-content"),P.Pb(),P.Qb(22,"ion-fab",10),P.Qb(23,"ion-button",11),P.Yb("click",function(){return e.addSubAccounts()}),P.Mb(24,"ion-icon",12),P.wc(25),P.bc(26,"translate"),P.bc(27,"translate"),P.Pb(),P.Pb(),P.Pb()),2&t&&(P.Ab(6),P.xc(P.dc(7,7,"add-sub-account.title",P.kc(19,m,P.cc(8,10,e.typeLabel)))),P.Ab(4),P.gc("ngModel",e.searchTerm),P.Ab(6),P.xc(P.cc(17,12,e.typeLabel)),P.Ab(2),P.gc("ngIf",!e.subAccounts.length),P.Ab(1),P.gc("ngForOf",e.displayedSubAccounts),P.Ab(4),P.gc("disabled",!e.subAccounts.length),P.Ab(2),P.yc(" ",P.dc(26,14,"add-sub-account.add-accounts_label",P.kc(21,m,P.cc(27,17,e.typeLabel)))," "))},styles:[".empty-list[_ngcontent-%COMP%]{height:50%}span[_ngcontent-%COMP%]{font-size:14px}"]}),t}(),S=o("1Mpf"),T=o("F07p"),k=function(){function t(){}return t.\u0275mod=P.Jb({type:t}),t.\u0275inj=P.Ib({factory:function(e){return new(e||t)},imports:[[r.ib,i.c,c.e,l.a,a.b,s.j.forChild([{path:"",component:v}]),n.e]]}),t}();P.rc(v,[r.v,r.u,r.hb,r.j,r.f,r.g,r.fb,r.S,r.ub,c.h,c.j,r.q,r.R,r.db,i.n,S.a,i.m,r.p,T.a,r.o,r.b,r.x,r.y,r.r,r.i,r.w],[a.c])}}]);