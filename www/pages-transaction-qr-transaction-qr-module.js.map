{"version":3,"sources":["./src/app/pages/transaction-qr/transaction-qr.ts","./src/app/pages/transaction-qr/transaction-qr.html","./src/app/pages/transaction-qr/transaction-qr.module.ts"],"names":[],"mappings":"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","file":"pages-transaction-qr-transaction-qr-module.js","sourcesContent":["import { Component } from '@angular/core'\nimport { ActivatedRoute, Router } from '@angular/router'\nimport { Platform } from '@ionic/angular'\nimport { IACMessageDefinitionObjectV3, IAirGapTransaction } from '@airgap/coinlib-core'\nimport BigNumber from 'bignumber.js'\n\nimport { ErrorCategory, handleErrorSentry } from '../../services/sentry-error-handler/sentry-error-handler'\n\n@Component({\n  selector: 'page-transaction-qr',\n  templateUrl: 'transaction-qr.html'\n})\nexport class TransactionQrPage {\n  public messageDefinitionObjects: IACMessageDefinitionObjectV3[] = []\n  public airGapTxs: IAirGapTransaction[] = null\n  public isBrowser: boolean = false\n  public qrDataTooBig: boolean = false\n  public interactionData: any\n  public displayRawData: boolean = false\n\n  public aggregatedInfo:\n    | {\n        numberOfTxs: number\n        totalAmount: BigNumber\n        totalFees: BigNumber\n      }\n    | undefined\n\n  constructor(private readonly router: Router, private readonly route: ActivatedRoute, private readonly platform: Platform) {\n    if (this.route.snapshot.data.special) {\n      const info = this.route.snapshot.data.special\n      this.airGapTxs = info.airGapTxs\n      this.interactionData = info.interactionData\n      this.messageDefinitionObjects = info.data\n      this.qrDataTooBig = this.messageDefinitionObjects.length > 2800\n\n      if (\n        this.airGapTxs &&\n        this.airGapTxs.length > 1 &&\n        this.airGapTxs.every((tx: IAirGapTransaction) => tx.protocolIdentifier === this.airGapTxs[0].protocolIdentifier)\n      ) {\n        this.aggregatedInfo = {\n          numberOfTxs: this.airGapTxs.length,\n          totalAmount: this.airGapTxs\n            .map((tx: IAirGapTransaction) => new BigNumber(tx.amount))\n            .filter((amount: BigNumber) => !amount.isNaN())\n            .reduce((pv: BigNumber, cv: BigNumber) => pv.plus(cv), new BigNumber(0)),\n          totalFees: this.airGapTxs.reduce((pv: BigNumber, cv: IAirGapTransaction) => pv.plus(cv.fee), new BigNumber(0))\n        }\n      }\n    }\n    this.isBrowser = !this.platform.is('hybrid')\n  }\n\n  public scanQr() {\n    this.router.navigateByUrl('/tabs/scan').catch(handleErrorSentry(ErrorCategory.NAVIGATION))\n  }\n\n  public done() {\n    this.router.navigateByUrl('/tabs/portfolio').catch(handleErrorSentry(ErrorCategory.NAVIGATION))\n  }\n\n  public toggleDisplayRawData(): void {\n    this.displayRawData = !this.displayRawData\n  }\n}\n","<ion-header class=\"ion-no-border\">\n  <ion-grid fixed=\"true\" class=\"ion-no-padding\">\n    <ion-toolbar>\n      <ion-buttons slot=\"start\">\n        <ion-back-button defaultHref=\"/\"></ion-back-button>\n      </ion-buttons>\n      <ion-title>{{ 'transaction-qr.title' | translate}}</ion-title>\n    </ion-toolbar>\n  </ion-grid>\n</ion-header>\n\n<ion-content class=\"ion-padding ion-margin-bottom\">\n  <ion-grid fixed=\"true\" class=\"ion-no-padding\">\n    <ion-row>\n      <h5 [innerHTML]=\"'transaction-qr.text' | translate\"></h5>\n    </ion-row>\n\n    <ion-row class=\"ion-justify-content-center ion-padding-vertical\">\n      <airgap-iac-qr\n        id=\"qr\"\n        *ngIf=\"!qrDataTooBig\"\n        [messageDefinitionObjects]=\"messageDefinitionObjects\"\n        [level]=\"'L'\"\n        [size]=\"300\"\n      ></airgap-iac-qr>\n\n      <ion-text>\n        <h1 *ngIf=\"qrDataTooBig\">{{ 'transaction-qr.qr-data-too-big_warning' | translate }}</h1>\n      </ion-text>\n    </ion-row>\n\n    <ng-container *ngIf=\"airGapTxs && airGapTxs.length > 1\">\n      <ion-row class=\"ion-padding-bottom ion-text-center\">\n        <ion-col size=\"4\" class=\"content--align__center-center\">\n          <h5>{{ aggregatedInfo.totalAmount.toFixed() | amountConverter: { protocol: airGapTxs[0].protocolIdentifier } | async }}</h5>\n        </ion-col>\n        <ion-col size=\"4\" class=\"content--align__center-center\">\n          <h5>{{ aggregatedInfo.numberOfTxs }}</h5>\n        </ion-col>\n        <ion-col size=\"4\" class=\"content--align__center-center\">\n          <h5>{{ aggregatedInfo.totalFees.toFixed() | feeConverter: { protocol: airGapTxs[0].protocolIdentifier } | async }}</h5>\n        </ion-col>\n        <ion-col size=\"4\">\n          <small>Amount</small>\n        </ion-col>\n        <ion-col size=\"4\">\n          <small>Operations</small>\n        </ion-col>\n        <ion-col size=\"4\">\n          <small>Fee</small>\n        </ion-col>\n      </ion-row>\n    </ng-container>\n\n    <ng-container *ngIf=\"airGapTxs\">\n      <airgap-from-to *ngFor=\"let airGapTx of airGapTxs\" class=\"ion-padding-horizontal\" [transaction]=\"airGapTx\"></airgap-from-to>\n    </ng-container>\n\n    <ng-container *ngIf=\"interactionData\">\n      <ion-row class=\"rawdata--container\">\n        <ion-col class=\"ion-no-padding\">\n          <ion-item class=\"ion-no-padding\" lines=\"none\">\n            <ion-label>{{ 'transaction-qr.details' | translate }}</ion-label>\n            <ion-toggle [checked]=\"displayRawData\" (ionChange)=\"toggleDisplayRawData()\" slot=\"end\"></ion-toggle>\n          </ion-item>\n          <pre *ngIf=\"displayRawData\" class=\"ion-no-margin\">{{ interactionData | json }}</pre>\n        </ion-col>\n      </ion-row>\n    </ng-container>\n  </ion-grid>\n\n  <ion-fab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\n    <ion-button id=\"done\" size=\"default\" color=\"primary\" (click)=\"done()\" shape=\"round\">\n      {{ 'transaction-qr.done_label' | translate }}\n    </ion-button>\n    <ion-button id=\"done\" size=\"default\" color=\"secondary\" (click)=\"scanQr()\" shape=\"round\">\n      {{ 'transaction-qr.scan_qr_label' | translate }}\n    </ion-button>\n  </ion-fab>\n</ion-content>\n","import { AirGapAngularCoreModule } from '@airgap/angular-core'\nimport { CommonModule } from '@angular/common'\nimport { NgModule } from '@angular/core'\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\nimport { RouterModule } from '@angular/router'\nimport { IonicModule } from '@ionic/angular'\nimport { TranslateModule } from '@ngx-translate/core'\n\nimport { ComponentsModule } from '../../components/components.module'\nimport { PipesModule } from '../../pipes/pipes.module'\n\nimport { TransactionQrPage } from './transaction-qr'\n\n@NgModule({\n  imports: [\n    AirGapAngularCoreModule,\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    TranslateModule,\n    ComponentsModule,\n    PipesModule,\n    RouterModule.forChild([{ path: '', component: TransactionQrPage }])\n  ],\n  declarations: [TransactionQrPage]\n})\nexport class TransactionQrPageModule {}\n"],"sourceRoot":"webpack:///"}